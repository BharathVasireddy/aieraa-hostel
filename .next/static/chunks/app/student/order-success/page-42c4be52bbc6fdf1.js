(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5375],{646:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},744:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("ChefHat",[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]])},1007:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},4516:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},4653:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j});var s=r(5155),a=r(2115),l=r(5695),n=r(4186),i=r(646),o=r(744),d=r(7108);let c=(0,r(9946).A)("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]]);var u=r(5339),x=r(7550),m=r(4516),h=r(1007),g=r(7340),b=r(6694),y=r(7198);let p=(e,t,r)=>{try{if(!e||"Invalid Date"===e||"null"===e||"undefined"===e)return r;let s=new Date(e);if(isNaN(s.getTime()))return r;return(0,b.GP)(s,t)}catch(e){return console.error("Date formatting error:",e),r}};function f(){let e=(0,l.useRouter)(),t=(0,l.useSearchParams)(),{user:r}=(0,y.J)(),b=t.get("orderId"),f=t.get("orderNumber"),[j,v]=(0,a.useState)(null),[N,w]=(0,a.useState)(!0),[A,C]=(0,a.useState)("");if((0,a.useEffect)(()=>{if(!b||!f){C("Order information not found"),w(!1);return}(async()=>{try{let e=await fetch("/api/orders/".concat(b)),t=await e.json();e.ok&&t.success?v(t.order):C(t.error||"Failed to fetch order details")}catch(e){console.error("Error fetching order:",e),C("Failed to fetch order details")}finally{w(!1)}})()},[b,f]),N)return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-white to-blue-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 border-4 border-green-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading order details..."})]})});if(A||!j)return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-white to-blue-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center px-4",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(d.A,{className:"w-8 h-8 text-gray-600"})}),(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Order Not Found"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:A||"The requested order could not be found."}),(0,s.jsx)("button",{onClick:()=>e.push("/student"),className:"px-6 py-3 bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-xl hover:from-green-600 hover:to-blue-600 transition-all duration-200",children:"Back to Dashboard"})]})});let k=(e=>{switch(e){case"PENDING":return{color:"bg-orange-500",bgColor:"bg-orange-50",textColor:"text-orange-800",icon:n.A,title:"Order Received",subtitle:"Your order has been received and is awaiting approval",description:"We have received your order and it will be reviewed shortly."};case"APPROVED":return{color:"bg-blue-500",bgColor:"bg-blue-50",textColor:"text-blue-800",icon:i.A,title:"Order Approved",subtitle:"Your order has been approved and sent to kitchen",description:"Great! Your order has been approved and is now in the preparation queue."};case"PREPARING":return{color:"bg-purple-500",bgColor:"bg-purple-50",textColor:"text-purple-800",icon:o.A,title:"Being Prepared",subtitle:"Our chefs are preparing your delicious meal",description:"Your food is currently being prepared in our kitchen with love and care."};case"READY":return{color:"bg-green-500",bgColor:"bg-green-50",textColor:"text-green-800",icon:d.A,title:"Ready for Collection",subtitle:"Your order is ready! Please collect it now",description:"Your order is ready and waiting for you at the collection counter."};case"SERVED":return{color:"bg-emerald-500",bgColor:"bg-emerald-50",textColor:"text-emerald-800",icon:c,title:"Order Completed",subtitle:"Your order has been successfully served",description:"Thank you for your order! We hope you enjoyed your meal."};case"REJECTED":return{color:"bg-red-500",bgColor:"bg-red-50",textColor:"text-red-800",icon:u.A,title:"Order Cancelled",subtitle:"Your order has been cancelled",description:"Unfortunately, your order could not be processed. You will receive a full refund."};case"CANCELLED":return{color:"bg-gray-500",bgColor:"bg-gray-50",textColor:"text-gray-800",icon:u.A,title:"Order Cancelled",subtitle:"Your order has been cancelled",description:"Your order has been cancelled. You will receive a full refund if payment was made."};default:return{color:"bg-gray-500",bgColor:"bg-gray-50",textColor:"text-gray-800",icon:n.A,title:"Processing Order",subtitle:"We are processing your order",description:"Your order is being processed. Please wait for updates."}}})(j.status),E=k.icon,P=(()=>{let e=[{status:"PENDING",label:"Order Placed",time:p(null==j?void 0:j.createdAt,"h:mm a","Just now"),icon:n.A},{status:"APPROVED",label:"Order Approved",time:p(null==j?void 0:j.approvedAt,"h:mm a","Pending"),icon:i.A},{status:"PREPARING",label:"Being Prepared",time:"Pending",icon:o.A},{status:"READY",label:"Ready for Collection",time:"Pending",icon:d.A},{status:"SERVED",label:"Order Completed",time:p(null==j?void 0:j.completedAt,"h:mm a","Pending"),icon:c}];return(null==j?void 0:j.status)==="REJECTED"||(null==j?void 0:j.status)==="CANCELLED"?[e[0],{status:j.status,label:"REJECTED"===j.status?"Order Rejected":"Order Cancelled",time:p(j.rejectedAt,"h:mm a","Recently"),icon:u.A}]:e})(),D=(()=>{if(!j)return 0;let e=["PENDING","APPROVED","PREPARING","READY","SERVED"].indexOf(j.status);return e>=0?e:0})();return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("div",{className:"bg-white border-b border-gray-200 px-4 py-4 sticky top-0 z-10",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("button",{onClick:()=>e.push("/student"),className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[(0,s.jsx)(x.A,{className:"w-5 h-5 mr-2"}),(0,s.jsx)("span",{className:"font-medium",children:"Dashboard"})]}),(0,s.jsx)("h1",{className:"text-lg font-bold text-gray-900",children:"Order Confirmation"}),(0,s.jsx)("div",{className:"w-20"})]})}),(0,s.jsxs)("div",{className:"px-4 py-6 space-y-6",children:[(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"w-24 h-24 ".concat(k.bgColor," rounded-full flex items-center justify-center mx-auto mb-6 animate-pulse"),children:(0,s.jsx)("div",{className:"w-20 h-20 ".concat(k.color," rounded-full flex items-center justify-center animate-bounce"),children:(0,s.jsx)(E,{className:"w-10 h-10 text-white"})})}),(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:[...Array(6)].map((e,t)=>(0,s.jsx)("div",{className:"absolute w-2 h-2 ".concat(k.color," rounded-full opacity-60 animate-ping"),style:{left:"".concat(20+15*t,"%"),top:"".concat(30+t%2*20,"%"),animationDelay:"".concat(.2*t,"s"),animationDuration:"2s"}},t))})]}),(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-3",children:k.title}),(0,s.jsx)("p",{className:"text-lg text-gray-600 mb-2",children:k.subtitle}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-4 max-w-md mx-auto",children:k.description}),(0,s.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["#",j.orderNumber]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Order Progress"}),(0,s.jsx)("div",{className:"space-y-4",children:P.map((e,t)=>{let r=t<=D,a=t===D,l=e.icon;return(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center border-2 ".concat(r?"bg-green-600 border-green-600":a?"".concat(k.color," border-green-600"):"bg-white border-gray-300"),children:(0,s.jsx)(l,{className:"w-5 h-5 ".concat(r||a?"text-white":"text-gray-400")})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-semibold ".concat(r||a?"text-gray-900":"text-gray-500"),children:e.label}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:e.time})]}),a&&(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-pulse"})})]},e.status)})})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Order Details"}),(0,s.jsx)("div",{className:"space-y-4",children:j.orderItems.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-100 last:border-0",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("h3",{className:"font-semibold text-gray-900",children:[e.menuItem.name,e.variant&&(0,s.jsxs)("span",{className:"text-gray-600",children:[" (",e.variant.name,")"]})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[e.menuItem.categories.join(", ")," â€¢ Qty: ",e.quantity]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("div",{className:"font-bold text-gray-900",children:["â‚¹",(e.price*e.quantity).toLocaleString()]}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:["â‚¹",e.price," each"]})]})]},e.id))}),(0,s.jsxs)("div",{className:"border-t border-gray-200 mt-6 pt-6 space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Subtotal"}),(0,s.jsxs)("span",{className:"font-medium text-gray-900",children:["â‚¹",j.subtotalAmount.toLocaleString()]})]}),(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Tax & Fees"}),(0,s.jsxs)("span",{className:"font-medium text-gray-900",children:["â‚¹",j.taxAmount.toLocaleString()]})]}),(0,s.jsxs)("div",{className:"flex justify-between text-xl font-bold border-t border-gray-200 pt-3",children:[(0,s.jsx)("span",{className:"text-gray-900",children:"Total Paid"}),(0,s.jsxs)("span",{className:"text-green-600",children:["â‚¹",j.totalAmount.toLocaleString()]})]})]}),j.specialInstructions&&(0,s.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-100",children:[(0,s.jsx)("h4",{className:"font-semibold text-blue-900 mb-2",children:"Special Instructions"}),(0,s.jsx)("p",{className:"text-blue-800",children:j.specialInstructions})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Collection Information"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4 p-4 bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:(0,s.jsx)(m.A,{className:"w-5 h-5 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold text-gray-900",children:j.user.university.name}),(0,s.jsx)("p",{className:"text-gray-600",children:"Main Food Court â€¢ Counter 2"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:j.user.university.address||"University Campus"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 p-4 bg-gradient-to-r from-green-50 to-green-100 rounded-xl",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center",children:(0,s.jsx)(h.A,{className:"w-5 h-5 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold text-gray-900",children:j.user.name}),(0,s.jsxs)("p",{className:"text-gray-600",children:["Room ",j.user.roomNumber||"Not specified"]}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:j.user.phone||j.user.email})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 p-4 bg-gradient-to-r from-orange-50 to-orange-100 rounded-xl",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-orange-600 rounded-lg flex items-center justify-center",children:(0,s.jsx)(n.A,{className:"w-5 h-5 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold text-gray-900",children:"Expected Collection"}),(0,s.jsxs)("p",{className:"text-gray-600",children:[p(null==j?void 0:j.orderDate,"EEEE, MMM dd","Today")," â€¢ 12:00 PM - 2:00 PM"]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Payment: ","cash"===j.paymentMethod?"Pay at Counter":"Online Payment","PAID"===j.paymentStatus?" (âœ“ Paid)":" (Pending)"]})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-3 pb-6",children:[(0,s.jsx)("button",{onClick:()=>e.push("/student/orders"),className:"w-full py-4 bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-xl font-semibold hover:from-green-600 hover:to-blue-600 transition-all duration-200 shadow-lg",children:"Track Order Status"}),(0,s.jsx)("button",{onClick:()=>e.push("/student/menu"),className:"w-full py-4 bg-white border-2 border-gray-200 text-gray-700 rounded-xl font-semibold hover:bg-gray-50 transition-all duration-200",children:"Order Again"}),(0,s.jsxs)("button",{onClick:()=>e.push("/student"),className:"w-full flex items-center justify-center space-x-2 py-3 text-gray-600 hover:text-gray-900 transition-colors",children:[(0,s.jsx)(g.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Back to Dashboard"})]})]})]})]})}function j(){return(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-white to-blue-50 flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-8 h-8 border-2 border-green-600 border-t-transparent rounded-full animate-spin"})}),children:(0,s.jsx)(f,{})})}},5339:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},6636:(e,t,r)=>{Promise.resolve().then(r.bind(r,4653))},7108:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},7198:(e,t,r)=>{"use strict";r.d(t,{J:()=>o,UserProvider:()=>i});var s=r(5155),a=r(2115),l=r(2108);let n=(0,a.createContext)(void 0);function i(e){let{children:t}=e,{data:r,status:i}=(0,l.useSession)(),[o,d]=(0,a.useState)(null),[c,u]=(0,a.useState)(!0),[x,m]=(0,a.useState)(null),[h,g]=(0,a.useState)(!1);(0,a.useEffect)(()=>{g(!0)},[]);let b=async()=>{var e;if(!(null==r||null==(e=r.user)?void 0:e.id)){d(null),u(!1);return}try{u(!0),m(null);let e=await fetch("/api/user/".concat(r.user.id)),t=await e.json();e.ok?d(t.user):404===e.status?(console.warn("User not found in database, forcing logout"),m("User account not found. Please login again."),await (0,l.signOut)({callbackUrl:"/auth/signin",redirect:!0})):m(t.error||"Failed to fetch user data")}catch(e){console.error("Error fetching user data:",e),m("Failed to fetch user data")}finally{u(!1)}};return(0,a.useEffect)(()=>{var e;h&&"loading"!==i&&("authenticated"===i&&(null==r||null==(e=r.user)?void 0:e.id)?b():(d(null),u(!1)))},[r,i,h]),(0,s.jsx)(n.Provider,{value:{user:o,loading:c||"loading"===i||!h,error:x,refetch:b,isMounted:h},children:t})}function o(){let e=(0,a.useContext)(n);if(void 0===e)throw Error("useUser must be used within a UserProvider");return e}},7340:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]])},7550:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[6454,4691,8441,1684,7358],()=>t(6636)),_N_E=e.O()}]);