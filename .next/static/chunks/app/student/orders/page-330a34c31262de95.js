(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2050],{646:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(9946).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},833:(e,r,t)=>{Promise.resolve().then(t.bind(t,3252))},2657:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(9946).A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},3252:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>N});var s=t(5155),a=t(2115),l=t(5339),d=t(646),n=t(744),c=t(7108),i=t(4861),o=t(4186),m=t(3904),x=t(7475),u=t(9074),h=t(2657),g=t(5695),b=t(6694),y=t(7163);let p=(e,r,t)=>{try{if(!e||"Invalid Date"===e||"null"===e||"undefined"===e)return t;let s=new Date(e);if(isNaN(s.getTime()))return t;return(0,b.GP)(s,r)}catch(e){return console.error("Date formatting error:",e),t}};function N(){let e=(0,g.useRouter)(),[r,t]=(0,a.useState)([]),[b,N]=(0,a.useState)(!0),[f,j]=(0,a.useState)(!1),[w,v]=(0,a.useState)("upcoming"),[A,k]=(0,a.useState)(null),E=(0,a.useCallback)(async()=>{try{N(!0),k(null);let e=await fetch("/api/orders");if(!e.ok)throw Error("Failed to fetch orders");let r=await e.json(),s=(r.orders||r||[]).sort((e,r)=>new Date(r.createdAt).getTime()-new Date(e.createdAt).getTime());t(s)}catch(e){console.error("Error fetching orders:",e),k("Failed to load orders"),t([])}finally{N(!1)}},[]);(0,a.useEffect)(()=>{E()},[E]);let D=async()=>{j(!0),await E(),j(!1)},P=e=>{switch(e){case"PENDING":return(0,s.jsx)(l.A,{className:"w-4 h-4 text-orange-600"});case"APPROVED":return(0,s.jsx)(d.A,{className:"w-4 h-4 text-blue-600"});case"PREPARING":return(0,s.jsx)(n.A,{className:"w-4 h-4 text-purple-600"});case"READY":return(0,s.jsx)(c.A,{className:"w-4 h-4 text-green-600"});case"SERVED":return(0,s.jsx)(d.A,{className:"w-4 h-4 text-emerald-600"});case"CANCELLED":return(0,s.jsx)(i.A,{className:"w-4 h-4 text-red-600"});default:return(0,s.jsx)(o.A,{className:"w-4 h-4 text-gray-600"})}},R=e=>{switch(e){case"PENDING":return"text-orange-800 bg-orange-100 border-orange-300";case"APPROVED":return"text-blue-800 bg-blue-100 border-blue-300";case"PREPARING":return"text-purple-800 bg-purple-100 border-purple-300";case"READY":return"text-green-800 bg-green-100 border-green-300";case"SERVED":return"text-emerald-800 bg-emerald-100 border-emerald-300";case"CANCELLED":return"text-red-800 bg-red-100 border-red-300";default:return"text-gray-800 bg-gray-100 border-gray-300"}},C=e=>{switch(e){case"PENDING":return"bg-gradient-to-r from-orange-50 to-orange-100";case"APPROVED":return"bg-gradient-to-r from-blue-50 to-blue-100";case"PREPARING":return"bg-gradient-to-r from-purple-50 to-purple-100";case"READY":return"bg-gradient-to-r from-green-50 to-green-100";case"SERVED":return"bg-gradient-to-r from-emerald-50 to-emerald-100";case"CANCELLED":return"bg-gradient-to-r from-red-50 to-red-100";default:return"bg-gradient-to-r from-gray-50 to-gray-100"}},M=e=>{switch(e){case"PENDING":return"Pending for Approval";case"APPROVED":return"Approved";case"PREPARING":return"Preparing";case"READY":return"Ready to Collect";case"SERVED":return"Served";case"CANCELLED":return"Cancelled";default:return e}},I=(r,t)=>{e.push("/student/orders/".concat(r,"?orderNumber=").concat(t))},L=(()=>{let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate());switch(w){case"upcoming":return r.filter(e=>new Date(e.orderDate)>=t||["PENDING","APPROVED","PREPARING","READY"].includes(e.status));case"all":return r;default:return r.filter(e=>e.status===w)}})();return(0,s.jsxs)(y.A,{showDatePicker:!1,className:"bg-gradient-to-br from-green-50 via-white to-blue-50",children:[(0,s.jsx)("div",{className:"bg-white/90 backdrop-blur-sm border-b border-green-200 px-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)(c.A,{className:"w-5 h-5 text-gray-700"})}),(0,s.jsx)("h1",{className:"text-lg font-bold text-gray-900",children:"My Orders"})]}),(0,s.jsx)("button",{onClick:D,disabled:f,className:"p-2 text-gray-600 hover:text-green-600 disabled:opacity-50 rounded-full hover:bg-green-50 transition-all duration-200",children:(0,s.jsx)(m.A,{className:"w-5 h-5 ".concat(f?"animate-spin":"")})})]})}),(0,s.jsxs)("div",{className:"px-4 py-4",children:[(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:[{key:"upcoming",label:"Upcoming"},{key:"all",label:"All Orders"},{key:"PENDING",label:"Pending"},{key:"APPROVED",label:"Approved"},{key:"PREPARING",label:"Preparing"},{key:"READY",label:"Ready"},{key:"SERVED",label:"Served"}].map(e=>(0,s.jsx)("button",{onClick:()=>v(e.key),className:"flex-shrink-0 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors border ".concat(w===e.key?"bg-green-600 text-white border-green-600":"bg-white text-gray-700 border-gray-200 hover:bg-green-50 hover:border-green-300"),children:e.label},e.key))})}),b?(0,s.jsx)("div",{className:"space-y-3",children:[1,2,3,4,5].map(e=>(0,s.jsxs)("div",{className:"bg-white rounded-2xl p-3 animate-pulse border border-gray-100 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-4 h-4 bg-gray-200 rounded"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"h-3 bg-gray-200 rounded w-16 mb-1"}),(0,s.jsx)("div",{className:"h-2 bg-gray-200 rounded w-12"})]})]}),(0,s.jsx)("div",{className:"w-4 h-4 bg-gray-200 rounded"})]}),(0,s.jsx)("div",{className:"h-2 bg-gray-200 rounded w-2/3 mb-2"}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"h-5 bg-gray-200 rounded w-12"}),(0,s.jsx)("div",{className:"h-3 bg-gray-200 rounded w-10"})]})]},e))}):A?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(i.A,{className:"w-8 h-8 text-red-600"})}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Failed to load orders"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:A}),(0,s.jsx)("button",{onClick:D,className:"px-6 py-3 bg-gradient-to-r from-green-500 to-blue-500 text-white text-sm font-medium rounded-xl hover:from-green-600 hover:to-blue-600 transition-all duration-200 shadow-md",children:"Try Again"})]}):0===L.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(c.A,{className:"w-8 h-8 text-gray-600"})}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"upcoming"===w?"No upcoming orders":"all"===w?"No orders yet":"No ".concat(w.toLowerCase()," orders")}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:"upcoming"===w?"You don't have any upcoming orders. Place an order to get started!":"all"===w?"Your order history will appear here once you place your first order":"You don't have any ".concat(w.toLowerCase()," orders at the moment")}),(0,s.jsx)("button",{onClick:()=>e.push("/student/menu"),className:"px-6 py-3 bg-gradient-to-r from-green-500 to-blue-500 text-white text-sm font-medium rounded-xl hover:from-green-600 hover:to-blue-600 transition-all duration-200 shadow-md",children:"Browse Menu"})]}):(0,s.jsx)("div",{className:"space-y-3",children:L.map(e=>(0,s.jsxs)("div",{className:"".concat(C(e.status)," rounded-2xl p-3 border border-white/50 hover:shadow-md transition-all duration-200 backdrop-blur-sm"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[P(e.status),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"font-semibold text-gray-900 text-sm",children:["#",e.orderNumber]}),(0,s.jsxs)("p",{className:"text-xs text-gray-600",children:[e.orderItems.length," item",1!==e.orderItems.length?"s":""]})]})]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsxs)("div",{className:"flex items-center text-lg font-bold text-gray-900",children:[(0,s.jsx)(x.A,{className:"w-4 h-4 mr-1"}),(0,s.jsxs)("span",{children:["₹",e.totalAmount.toFixed(0)]})]})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("span",{className:"px-2 py-1 rounded-lg text-xs font-medium border ".concat(R(e.status)),children:M(e.status)}),(0,s.jsxs)("div",{className:"flex items-center text-xs text-gray-500",children:[(0,s.jsx)(u.A,{className:"w-3 h-3 mr-1"}),(0,s.jsxs)("span",{children:["For ",p(e.orderDate,"MMM dd","N/A")]})]})]}),(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsxs)("div",{className:"text-xs text-gray-700",children:[e.orderItems.slice(0,2).map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between py-0.5",children:[(0,s.jsxs)("span",{children:[e.quantity,"x ",e.menuItem.name]}),(0,s.jsxs)("span",{className:"text-gray-500 font-medium",children:["₹",(e.price*e.quantity).toFixed(0)]})]},e.id)),e.orderItems.length>2&&(0,s.jsxs)("div",{className:"text-xs text-gray-500 pt-0.5",children:["+",e.orderItems.length-2," more items"]})]})}),(0,s.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-white/70",children:[(0,s.jsx)("div",{className:"text-xs text-gray-500",children:p(e.createdAt,"MMM dd, h:mm a","N/A")}),(0,s.jsxs)("button",{onClick:()=>I(e.id,e.orderNumber),className:"flex items-center space-x-1 px-3 py-1.5 bg-white/80 hover:bg-white text-gray-700 text-xs font-medium rounded-lg transition-colors border border-white/50",children:[(0,s.jsx)(h.A,{className:"w-3 h-3"}),(0,s.jsx)("span",{children:"View"})]})]})]},e.id))})]})]})}},3904:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(9946).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},4861:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(9946).A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},5339:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(9946).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},7108:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(9946).A)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},7475:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(9946).A)("IndianRupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]])}},e=>{var r=r=>e(e.s=r);e.O(0,[6454,4691,7163,8441,1684,7358],()=>r(833)),_N_E=e.O()}]);