"use strict";(()=>{var e={};e.id=8887,e.ids=[8887],e.modules={1708:e=>{e.exports=require("node:process")},3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7066:e=>{e.exports=require("node:tty")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},16698:e=>{e.exports=require("node:async_hooks")},29021:e=>{e.exports=require("fs")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31183:(e,r,t)=>{t.d(r,{z:()=>o});var s=t(38824);let o=globalThis.prisma??new s.PrismaClient},31421:e=>{e.exports=require("node:child_process")},33873:e=>{e.exports=require("path")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},48161:e=>{e.exports=require("node:os")},50154:(e,r,t)=>{t.r(r),t.d(r,{patchFetch:()=>f,routeModule:()=>x,serverHooks:()=>q,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>h});var s={};t.r(s),t.d(s,{POST:()=>l});var o=t(96559),n=t(48088),a=t(37719),i=t(32190),u=t(85663),p=t(31183),d=t(38824);async function l(e){try{let{name:r,email:t,password:s,universityId:o,studentId:n,roomNumber:a,phone:l,role:x="STUDENT"}=await e.json();if(!r||!t||!s||!o)return i.NextResponse.json({error:"Missing required fields"},{status:400});if("STUDENT"!==x)return i.NextResponse.json({error:"Only student registration is allowed"},{status:400});if(!n||!a||!l)return i.NextResponse.json({error:"Student ID, room number, and phone are required for student registration"},{status:400});if(s.length<6)return i.NextResponse.json({error:"Password must be at least 6 characters long"},{status:400});if(!/^(\+?91|0)?[6-9]\d{9}$|^(\+?84|0)?[1-9]\d{8}$/.test(l.replace(/\D/g,"")))return i.NextResponse.json({error:"Please enter a valid Indian or Vietnamese phone number"},{status:400});if(await p.z.user.findUnique({where:{email:t}}))return i.NextResponse.json({error:"User with this email already exists"},{status:400});if(!await p.z.university.findUnique({where:{id:o}}))return i.NextResponse.json({error:"Invalid university selected"},{status:400});let c=await u.Ay.hash(s,12),h=await p.z.user.create({data:{name:r,email:t,password:c,role:d.UserRole.STUDENT,status:d.UserStatus.PENDING,universityId:o,studentId:n,roomNumber:a,phone:l},select:{id:!0,name:!0,email:!0,role:!0,status:!0,createdAt:!0}});return i.NextResponse.json({message:"Student account created successfully. Please wait for admin approval.",user:h})}catch(e){return console.error("Signup error:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}let x=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/auth/signup/route",pathname:"/api/auth/signup",filename:"route",bundlePath:"app/api/auth/signup/route"},resolvedPagePath:"/Users/bharat/Desktop/aieraa-hostel/src/app/api/auth/signup/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:c,workUnitAsyncStorage:h,serverHooks:q}=x;function f(){return(0,a.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:h})}},51455:e=>{e.exports=require("node:fs/promises")},55511:e=>{e.exports=require("crypto")},57975:e=>{e.exports=require("node:util")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73024:e=>{e.exports=require("node:fs")},76760:e=>{e.exports=require("node:path")},77598:e=>{e.exports=require("node:crypto")},78474:e=>{e.exports=require("node:events")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[4243,580,5663,1748],()=>t(50154));module.exports=s})();